




<!DOCTYPE html>
<html>
  <head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167283455-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-167283455-3');
    </script>

    <link rel="shortcut icon" href="https://storage.googleapis.com/starthinker-ui/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://storage.googleapis.com/starthinker-ui/favicon.ico" type="image/x-icon">

    <!--Import Google Icon Font-->
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://storage.googleapis.com/starthinker-ui/css/materialize-1.0.0.min.css">

    <style>
      html { color: rgba(68,68,68,1); font-family: Roboto, sans-serif; }
 
      .material-icons { line-height: normal; vertical-align: middle; }

      #message { justify-content: center; font-size: 2em;}
      #message i { font-size: 2em; margin: 10px; }
      #message ul, #message li { display: inline; margin-left: 10px; }
      #page { width: 100%; max-width: 1280px; min-height: 500px; margin: 0px auto; padding-bottom: 50px; }

      div.nav-wrapper { padding-left: 1%; padding-right: 1%; }
      h1 a i.material-icons { font-size: 4rem; }
      a.brand-logo img { vertical-align: middle; width: 40px; height: 40px; }
      ol li { line-height: 1.8em; }
      textarea { margin-top: 7px; height: 10rem; }
      table.list { width: 96%; max-width: 800px; margin: 1vh auto; line-height: 1.8em; }
      a.menu_link, span.menu_link { display: inline-block; margin: 8px; }

      div.row { display: flex; align-items: flex-start; justify-content: center; flex-wrap: wrap; }

      #cards div.card { width: 300px; margin: 20px; padding: 0.1px; text-align: left; }
      div.card h4 { width 100%; padding: 20px;}
      div.card h4 i.material-icons { font-size: 2.28rem; }
      div.card table { margin: 0px 5% 30px 5%; width: 90%; }

      .card .card-content .card-title { word-wrap: break-word; }
      div.input-field { padding-top: 0.1px; margin-top: 2.4em;}

      div.switch { padding-top: 1rem; padding-bottom: 1rem; }
      div.switch label { font-size: 1.05rem; }
      div.switch label:first-child { font-size: 1.3rem; margin-right: 40px; }

      p.flow-text { font-weight: 100; }
      i.right { margin: 0px 15px; font-size: 1.5rem;}
      .collapsible-body { padding: 0px; }

      
  #solution_image { margin: 30px auto; width: 80%; max-width: 800px; height: auto; display: block; }
  .btn-large { margin: 1vh 1vw; } 
  .col { margin-right: auto; }
  pre.expand_code { height: 70vh; overflow: hidden; }
  pre.expand_code span { position: absolute; right: 0px; margin: 15px; cursor: pointer; }

    </style>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  
    <nav class="green lighten-0">
      <div class="nav-wrapper">
        <a href="/starthinker/" class="brand-logo">
          <img src="https://storage.googleapis.com/starthinker-ui/StarThinker.png"/>&nbsp;StarThinker
        </a>
        <a href="#" data-target="mobile-menu" class="sidenav-trigger"><i class="material-icons">menu</i></a>
  
        <ul id="nav-mobile" class="right hide-on-med-and-down">
          
          
          <li><a href="/starthinker/solution/">Solutions</a></li>
          <li><a href="/starthinker/help/">Help</a></li>
          
        </ul>
      </div>
    </nav>
  
    <ul class="sidenav green lighten-1" id="mobile-menu">
      
      
      
      <li><a class="white-text" href="/starthinker/solution/">Solutions</a></li>
      <li><a class="white-text" href="/starthinker/help/">Help</a></li>
      
    </ul>
  

  <body>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://storage.googleapis.com/starthinker-ui/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="https://storage.googleapis.com/starthinker-ui/js/materialize-1.0.0.min.js"></script>

    


<!--
Start of Floodlight Tag: Please do not remove
Activity name of this tag: Gallery Conversions
URL of the webpage where the tag is expected to be placed: https://google.github.io/starthinker/
This tag must be placed between the <body> and </body> tags, as close as possible to the opening tag.
Creation Date: 03/09/2020
-->
<script type="text/javascript">
var axel = Math.random() + "";
var a = axel * 10000000000000;
document.write('<img src="https://ad.doubleclick.net/ddm/activity/src=8657867;type=github;cat=galle0;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=' + a + '?" width="1" height="1" alt=""/>');
</script>
<noscript>
<img src="https://ad.doubleclick.net/ddm/activity/src=8657867;type=github;cat=galle0;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?" width="1" height="1" alt=""/>
</noscript>
<!-- End of Floodlight Tag: Please do not remove -->



    

    <div id="page" class="center">
      

  <br/>
  <h1><i class="medium material-icons">addchart</i>&nbsp; Pearson Correlation Significance Function</h1>
  <p class="flow-text">Add function to dataset for checking if correlation is significant.</p>

  <a class="trigger_category menu_link waves-effect waves-dark btn-flat grey lighten-2" href="/starthinker/solution/">All</a>
  

  <br/><br/>
  

  

  <div class="buttons">

    <a class="btn-large blue waves-effect waves-light" href="https://groups.google.com/d/forum/starthinker-assets" target="_blank">
      <i class="material-icons right">lock_open</i>Get Access
    </a>

    

    

    

    <br/>

    

    
      <a class="btn-large blue waves-effect waves-light" href="https://github.com/google/starthinker/blob/master/scripts/bigquery_pearson_significance.json" target="_blank">
        <i class="material-icons right">list</i>Git Hub
      </a>
      <a class="btn-large blue waves-effect waves-light" href="https://colab.research.google.com/github/google/starthinker/blob/master/colabs/bigquery_pearson_significance.ipynb" target="_blank">
        <i class="material-icons right">copyright</i>Data Pill Colab
      </a>
      <a class="btn-large blue waves-effect waves-light" href="https://github.com/google/starthinker/blob/master/dags/bigquery_pearson_significance_dag.py" target="_blank">
        <i class="material-icons right">copyright</i>Airflow DAG
      </a>
    

  </div>

  <br/><br/>

  <div class="row">
    
  
    

    <div class="col s12 m6 l4">
      <div class="card">
        <table class="bordered">
          <thead>
            <tr>
              <th colspan="2">Details</th>
            </tr>
           </thead>
          <tbody>
    
            
            <tr>
              <td colspan="2">This solution has anonymized data and is OK to share with clients.</td>
            </tr>
            
    
            <tr>
              <td>Age</td>
              <td>July 7, 2020 (3 weeks, 1 day)</td>
            </tr>
    
            <tr>
              <td>Authors</td>
              <td><a href="mailto:kenjora@google.com?subject=Request+For+A+Pearson+Correlation+Significance+Function+StarThinker+Solution&body=Hi%2C%0A%0AI%27d+like+to+learn+more+about+the+Pearson+Correlation+Significance+Function+solution.%0A%0AStarThinker+Link%3A+http%3A%2F%2Flocalhost%3A8000%2Fsolution%2Fbigquery_pearson_significance%2F%0A%0ACan+we+set+up+some+time+to+over+it%3F%0A%0AThanks" target="_blank">kenjora@google.com</a>
              </td>
            </tr>

          </tbody>
        </table>
      </div>
    </div>
    
   
      <div class="col s12 m6 l4">
        <div class="card">
          <table class="bordered">
          <thead>
              <tr>
                <th>Instructions</th>
              </tr>
             </thead>
             <tbody>
             
               <tr>
                 <td>Specify the dataset, and the function will be added and available.</td>
               </tr>
             
             </tbody>
          </table>
        </div>
       </div>
     

    <div class="col s12 m12 l8">
      <pre class="card expand_code left-align"><span class="expand_code waves-light">Workflow<i class="material-icons medium">expand_more</i></span><code class="language-json">[
    {
        "<a href="https://github.com/google/starthinker/tree/master/starthinker/task/bigquery/run.py" target="_blank">bigquery</a>": {
            "auth": {
                "field": {
                    "name": "auth",
                    "kind": "authentication",
                    "order": 0,
                    "default": "service",
                    "description": "Credentials used for writing data."
                }
            },
            "run": {
                "query": "           CREATE FUNCTION IF NOT EXISTS [PARAMETER].pearson_significance_test(correlation FLOAT64, population INT64, percent FLOAT64, threshold FLOAT64)             RETURNS INT64             LANGUAGE js AS             '''               /* correlation = value from CORR function. */               /* population = number of mesurements. */               /* percent = 80, 90, 98, 99, 99.5, 99.95 certainty ( aka sigma ). */               /* threshold = usually 0.5, the minimum correlation value to be considered significant. */               /* returns = -1 for negative significant correlation, 0 for no significant correlation ( null hypothesis), and 1 for positive siginificant correlation. */               /* Example: SELECT pearson_significance_test(Impression_Correlation, Data_Point_Count, 95, 0.5) AS Female_Impression_Significant FROM ... */               if (Math.abs(correlation) < threshold) { return 0; }               var dt_lookup = [                 [1, .9511, .9877, .9969, .9995, .9999, .9999], /* 0 */                 [2, .8000, .9000, .9500, .9800, .9900, .9990], /* 1 */                 [3, .6870, .8054, .8783, .9343, .9587, .9911], /* 2 */                 [4, .6084, .7293, .8114, .8822, .9172, .9741], /* 3 */                 [5, .5509, .6694, .7545, .8329, .8745, .9509], /* 4 */                 [6, .5067, .6215, .7067, .7887, .8343, .9249], /* 5 */                 [7, .4716, .5822, .6664, .7498, .7977, .8983], /* 6 */                 [8, .4428, .5494, .6319, .7155, .7646, .8721], /* 7 */                 [9, .4187, .5214, .6021, .6851, .7348, .8470], /* 8 */                 [10, .3981, .4973, .5760, .6581, .7079, .8233], /* 9 */                 [11, .3802, .4762, .5529, .6339, .6835, .8010], /* 10 */                 [12, .3646, .4575, .5324, .6120, .6614, .7800], /* 11 */                 [13, .3507, .4409, .5140, .5923, .6411, .7604], /* 12 */                 [14, .3383, .4259, .4973, .5742, .6226, .7419], /* 13 */                 [15, .3271, .4124, .4821, .5577, .6055, .7247], /* 14 */                 [16, .3170, .4000, .4683, .5425, .5897, .7084], /* 15 */                 [17, .3077, .3887, .4555, .5285, .5751, .6932], /* 16 */                 [18, .2992, .3783, .4438, .5155, .5614, .6788], /* 17 */                 [19, .2914, .3687, .4329, .5034, .5487, .6652], /* 18 */                 [20, .2841, .3598, .4227, .4921, .5368, .6524], /* 29 */                 [21, .2774, .3515, .4132, .4815, .5256, .6402], /* 20 */                 [22, .2711, .3438, .4044, .4716, .5151, .6287], /* 21 */                 [23, .2653, .3365, .3961, .4622, .5052, .6178], /* 22 */                 [24, .2598, .3297, .3882, .4534, .4958, .6074], /* 23 */                 [25, .2546, .3233, .3809, .4451, .4869, .5974], /* 24 */                 [30, .2327, .2960, .3494, .4093, .4487, .5541], /* 25 */                 [35, .2156, .2746, .3246, .3810, .4182, .5189], /* 26 */                 [40, .2018, .2573, .3044, .3578, .3932, .4896], /* 27 */                 [50, .1806, .2306, .2732, .3218, .3542, .4432], /* 28 */                 [60, .1650, .2108, .2500, .2948, .3248, .4079], /* 29 */                 [70, .1528, .1954, .2319, .2737, .3017, .3798], /* 30 */                 [80, .1430, .1829, .2172, .2565, .2830, .3568], /* 31 */                 [90, .1348, .1726, .2050, .2422, .2673, .3375], /* 32 */                 [100, .1279, .1638, .1946, .2301, .2540, .3211], /* 33 */                 [150, .1045, .1339, .1593, .1886, .2084, .2643], /* 34 */                 [300, .0740, .0948, .1129, .1338, .1480, .1884], /* 35 */                 [500, .0573, .0735, .0875, .1038, .1149, .1464], /* 36 */                 [1000, .0405, .0520, .0619, .0735, .0813, .1038] /* 37 */               ]               populatuion = population - 2;               var dt_low = 0;               var dt_high = 0;               var dt_sigma = 0;               if (percent == 80) { dt_sigma = 1; }               else if (percent == 90) { dt_sigma = 2; }               else if (percent == 95) { dt_sigma = 3; }               else if (percent == 98) { dt_sigma = 4; }               else if (percent == 99.5) { dt_sigma = 5; }               else if (percent == 99.95) { dt_sigma = 6; }               else { dt_sigma = 5; }               if (population >= 1000) { dt_low = 37; dt_high = 37; }               else if (population >= 500) { dt_low = 36; dt_high = 37; }               else if (population >= 300) { dt_low = 35; dt_high = 36; }               else if (population >= 150) { dt_low = 34; dt_high = 35; }               else if (population >= 100) { dt_low = 33; dt_high = 34; }               else if (population >= 90) { dt_low = 32; dt_high = 33; }               else if (population >= 80) { dt_low = 31; dt_high = 32; }               else if (population >= 70) { dt_low = 30; dt_high = 31; }               else if (population >= 60) { dt_low = 29; dt_high = 30; }               else if (population >= 50) { dt_low = 28; dt_high = 29; }               else if (population >= 40) { dt_low = 27; dt_high = 28; }               else if (population >= 35) { dt_low = 26; dt_high = 27; }               else if (population >= 30) { dt_low = 25; dt_high = 26; }               else if (population > 25) { dt_low = 24; dt_high = 25; }               else if (population > 0) { dt_low = population; dt_high = population; }               else { return 0; }               if (dt_low == dt_high) {                 if (Math.abs(correlation) > dt_lookup[dt_low][dt_sigma] ) { return Math.sign(correlation); }                 else { return 0; }                  } else {                 if (Math.abs(correlation) > dt_lookup[dt_low][dt_sigma] + ((dt_lookup[dt_high][dt_sigma] - dt_lookup[dt_low][dt_sigma]) * ((population - dt_lookup[dt_low][0]) / (dt_lookup[dt_high][0] - dt_lookup[dt_low][0])))) { return Math.sign(correlation); }                 else { return 0; }                }             ''';         ",
                "legacy": false,
                "parameters": [
                    {
                        "field": {
                            "name": "dataset",
                            "kind": "string",
                            "order": 1,
                            "default": "",
                            "description": "Existing BigQuery dataset."
                        }
                    }
                ]
            }
        }
    }
]</code></pre>
    </div>

  </div>

  <br/><br/>
  <h3 id="code-tasks">Run This Workflow In Minutes On Google Cloud</h3>
  <p class="flow-text">Everything from a quick Google Cloud UI to reference developer code for your team in one GitHub repository.</p>
  <p>
    <a href="https://github.com/google/starthinker/blob/master/tutorials/README.md#deployment" class="waves-effect waves-light btn blue form_button modal-trigger" target="_blank">
      Deployment Steps<i class="material-icons right">launch</i>
    </a>
    <a href="https://github.com/google/starthinker/blob/master/tutorials/README.md#development" class="waves-effect waves-light btn blue form_button modal-trigger" target="_blank">
      Developer Guide<i class="material-icons right">build</i>
    </a>
    <a href="https://google.github.io/starthinker/help/" class="waves-effect waves-light btn blue form_button modal-trigger" target="_blank">
      UI How To<i class="material-icons right">laptop</i>
    </a>
  </p>



    </div>

  </body>

  

<footer class="page-footer red lighten-1">
  <div class="footer-copyright">
    <div class="container center">
    &copy; 2019 Google LLC
    </div>
  </div>
</footer>


  <script type="text/javascript">
    $(document).ready(function() {
      M.AutoInit();
    });
  </script>

  
  <script type="text/javascript">
    $(document).ready(function() {
      $('span.expand_code').on('click tap', function() {
        $('pre.expand_code').css('height', 'auto');
        $(this).hide();
      });
    });
  </script>


</html>
